# 文章脉络
> 1.将随机变量作为结点，若两个随机变量相关或者不独立，则将二者连接一条边；若给定若干随机变量，则形成一个有向图，即构成一个**网络**。<br>
> 2.如果该网络是有向无环图，则这个网络称为**贝叶斯网络**。<br>
> 3.如果这个图退化成线性链的方式，则得到**马尔可夫模型**；因为每个结点都是随机变量，将其看成各个时刻(或空间)的相关变化，以随机过程的视角，则可以看成是**马尔可夫过程**。<br>
> 4.若上述网络是无向的，则是无向图模型，又称**马尔可夫随机场或者马尔可夫网络**。<br>
> 5.如果在给定某些条件的前提下，研究这个马尔可夫随机场，则得到**条件随机场**。<br>
> 6.如果使用条件随机场解决标注问题，并且进一步将条件随机场中的网络拓扑变成线性的，则得到**线性链条件随机场**。<br>

# 一、马尔可夫模型
## 1.马尔可夫过程
马尔可夫过程（Markov process）是一类随机过程。它的原始模型马尔可夫链。该过程具有如下特性：在已知目前状态（现在）的条件下，它未来的演变（将来）不依赖于它以往的演变 (过去 )。例如液体中微粒所作的布朗运动、传染病受感染的人数等，都可视为**马尔可夫过程**。<br>

## 2.马尔可夫假设
每个状态的转移只依赖于之前的n个状态，这个过程被称为1个n阶的模型，其中n是影响转移状态的数目。最简单的马尔可夫过程就是一阶过程，**每一个状态的转移只依赖于其之前的那一个状态**，这个也叫作**马尔可夫性质**。<br>

假设这个模型的每个状态都只依赖于之前的状态，这个假设被称为**马尔科夫假设**，假设天气服从**马尔可夫链**:<br>
![天气马尔可夫链](https://github.com/yiyading/NLP/blob/master/img/%E5%A4%A9%E6%B0%94%E9%A9%AC%E5%B0%94%E7%A7%91%E5%A4%AB%E9%93%BE.png)
从上面这幅图可以看出：<br>
* 假如今天是晴天，明天变成阴天的概率是0.1<br>
* 假如今天是晴天，明天任然是晴天的概率是0.9，和上一条概率之和为1，这也符合真实生活的情况。<br>

由上表我们可以得到马尔可夫链的**状态转移矩阵**：<br>
![状态转移矩阵](https://github.com/yiyading/NLP/blob/master/img/%E5%A4%A9%E6%B0%94%E9%A9%AC%E5%B0%94%E7%A7%91%E5%A4%AB%E9%93%BE%E7%8A%B6%E6%80%81%E8%BD%AC%E7%A7%BB%E7%9F%A9%E9%98%B5.png)

因此，一阶马尔可夫过程定义了以下三个部分：<br>
* 状态：晴天和阴天<br>
* 初始向量：定义系统在时间为0的时候的状态的概率<br>
* 状态转移矩阵：每种天气转换的概率<br>

# 二、隐马尔可夫模型(HMM)
在某些情况下马尔科夫过程不足以描述我们希望发现的模式。回到之前那个天气的例子，一个隐居的人可能不能直观的观察到天气的情况，但是有一些海藻。民间的传说告诉我们海藻的状态在某种概率上是和天气的情况相关的。在这种情况下我们有两个状态集合，一个可以观察到的状态集合（海藻的状态）和一个隐藏的状态（天气的状况）。我们希望能找到一个算法可以根据海藻的状况和马尔科夫假设来预测天气的状况。
> 这个算法就叫做**隐马尔可夫模型(HMM)**。<br>
> 这个算法使用**可观察到的状态集合**去预测**隐藏的状态**。<br>
![隐马尔可夫模型示意图](https://github.com/yiyading/NLP/blob/master/img/%E9%9A%90%E9%A9%AC%E5%B0%94%E7%A7%91%E5%A4%AB%E6%A8%A1%E5%9E%8B%E7%A4%BA%E6%84%8F%E5%9B%BE.png)

## 1.隐马尔可夫三大问题
> 1.给定模型，如何有效计算产生观测序列的概率？换言之，如何评估模型与观测序列之间的匹配程度？<br>
> 2.给定模型和观测序列，如何找到与此观测序列最匹配的状态序列？换言之，如何根据观测序列推断出隐藏的模型状态？<br>
> 3.给定观测序列，如何调整模型参数使得该序列出现的概率最大？换言之，如何训练模型使其能最好地描述观测数据？

前两个问题是模式识别的问题：<br>
> 1).根据隐马尔科夫模型得到一个可观察状态序列的概率(**评价**)；<br>
> 2)找到一个隐藏状态的序列使得这个序列产生一个可观察状态序列的概率最大(**解码**)。<br>

第三个问题:<br>
> 根据一个可以观察到的状态序列集产生一个隐马尔科夫模型（**学习**）。<br>

对应的三大问题解法：
> 1)向前算法(Forward Algorithm)、向后算法(Backward Algorithm)<br>
> 2)维特比算法(Viterbi Algorithm)<br>
> 3)鲍姆-韦尔奇算法(Baum-Welch Algorithm) (约等于EM算法)<br>

## 2.举个”栗子“<br>
小明现在有三天的假期，他为了打发时间，可以在每一天中选择三件事情来做，这三件事情分别是散步、购物、打扫卫生(**对应着可观测序列**)，可是在生活中我们所做的决定一般都受到天气的影响，可能晴天的时候想要去购物或者散步，可能下雨天的时候不想出门，留在家里打扫卫生。而天气(晴天、下雨天)就属于**隐藏状态**，用一幅概率图来表示这一马尔可夫过程：<br>
![天气隐马尔可夫概率图](https://github.com/yiyading/NLP/blob/master/img/%E5%A4%A9%E6%B0%94%E9%9A%90%E9%A9%AC%E5%B0%94%E5%8F%AF%E5%A4%AB.png)<br>
那么，我们提出三个问题，分别对应马尔可夫的三大问题：<br>

1.已知整个模型，我观测到连续三天做的事情是：散步，购物，收拾。那么，根据模型，计算产生这些行为的概率是多少。<br>
2.同样知晓这个模型，同样是这三件事，我想猜，这三天的天气是怎么样的。<br>
3.最复杂的，我只知道这三天做了这三件事儿，而其他什么信息都没有。我得建立一个模型，晴雨转换概率，第一天天气情况的概率分布，根据天气情况选择做某事的概率分布。<br>


